<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Pago seguro | Funko Pops Custom</title>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Cormorant+Garamond:ital,wght@0,400;0,600&family=Source+Serif+4:ital,wght@0,400;0,600&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
  </head>
  <body>
    <header class="header">
      <div class="container header__content">
        <a href="{{ url_for('home') }}" class="header__brand">
          <img src="{{ logo_url }}" alt="Funko Pops Custom" class="header__logo-img" width="48" height="48" />
          <div>
            <span class="header__title">Funko Pops Custom</span>
            <span class="header__subtitle">Artesanía hecha a mano</span>
          </div>
        </a>
      </div>
    </header>
    <main class="section">
      <div class="container container--narrow">
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <div class="flash-messages">
              {% for category, msg in messages %}
                <p class="flash flash--{{ category }}">{{ msg }}</p>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}
        <h1 class="page-title">Pago seguro</h1>
        <p>Tu pedido ({{ items|length }} artículo{{ 's' if items|length != 1 else '' }}) — <strong>Total: {{ total }} €</strong>.</p>

        {% if stripe_ok %}
        <p>Serás redirigido a la pasarela de pago de Stripe para pagar con tarjeta de forma segura.</p>
        <form action="{{ url_for('crear_pago') }}" method="post">
          <button type="submit" class="button button--cart button--submit">Ir a pagar con tarjeta (Stripe)</button>
        </form>
        {% else %}
        <p class="checkout-no-stripe">Para activar los pagos, configura la variable de entorno <code>STRIPE_SECRET_KEY</code> con tu clave secreta de Stripe e instala: <code>pip install stripe</code>.</p>
        {% endif %}

        <p style="margin-top:1.5rem;"><a href="{{ url_for('carrito') }}" class="button button--outline">Volver al carrito</a> <a href="{{ url_for('home') }}" class="button button--outline">Volver al inicio</a></p>
      </div>
    </main>
    <footer class="footer">
      <div class="container footer__content">
        <p>© 2025 Funko Pops Custom.</p>
      </div>
    </footer>
  </body>
</html>
